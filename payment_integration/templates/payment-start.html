<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Gateway Analysis</title>
    <link rel="stylesheet" href="{% static 'css\payment-start.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body {
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        .blurred {
            filter: blur(10px);
        }
        .continue-btn {
            opacity: 0.5;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .continue-btn.enabled {
            opacity: 1;
            pointer-events: auto;
        }
    </style>
</head>
<body>
    <div class="box">
        <div class="upper-section">
            <div class="payment-logo">
                <img src="/static/images/image_1.png" alt="Payment Logo">
            </div>
            <div class="payment-head">
                <h3>Payment Gateway Analysis</h3>
            </div>
            <div class="payment-account">
                <img src="/static/images/user.png" alt="User" style="margin-left: -50px; margin-top:30px; opacity: 0.3;" height="40px" width="40px">
                <h6 style="margin-top: -40px; color:#003B8B;">{{full_name}}</h6>
                <h6 style="color: black; margin-top: -10px;">{{email}}</h6>
            </div>
        </div>

        <div class="payment-content">
            <strong>Payment Gateway Section Instructions:</strong><br>
            <p>
                1) This section evaluates your understanding of the logic and algorithm behind the live payment gateway process.<br><br>
                2) You are required to first check the functionality of the payment architecture solutions.<br><br>
                3) Complete the steps in the payment gateway architecture section to access and attempt subsequent questions.<br>
            </p><br>
            <div class="content-check">
                <input type="checkbox" id="check-first">
                <span>Acknowledged</span>
            </div>
            <form action="{% url 'payment_integration:initiate-payment' %}" method="POST" class="pass-box">
                {% csrf_token %}
                <button class="continue-btn" id="cont-btn" type="submit" disabled>Continue</button>
            </form>
        </div>
    </div>

    <script>
        // Disable context menu and certain key combinations
        document.addEventListener('contextmenu', event => event.preventDefault());

        document.addEventListener('keydown', event => {
            if ((event.ctrlKey || event.metaKey) && (event.key === 'c' || event.key === 'u' || event.key === 's')) {
                event.preventDefault();
            }
            if (event.key === 'PrintScreen' || event.key === 'Escape') {
                event.preventDefault();
            }
        });

        // Handle checkbox logic
        const checkbox = document.getElementById('check-first');
        const button = document.getElementById('cont-btn');

        checkbox.addEventListener('change', () => {
            if (checkbox.checked) {
                button.classList.add('enabled');
                button.removeAttribute('disabled');
            } else {
                button.classList.remove('enabled');
                button.setAttribute('disabled', 'true');
            }
        });

        // Add blur effect during certain key presses
        let isMetaKeyPressed = false;

        document.addEventListener('keydown', e => {
            if (e.key === 'Meta' && !isMetaKeyPressed) {
                isMetaKeyPressed = true;  
                document.body.classList.add('blurred');
            }
        });

        document.addEventListener('keyup', e => {
            if (e.key === 'Meta') {
                isMetaKeyPressed = false;
                document.body.classList.remove('blurred');
            }

            if (e.key === 'PrintScreen') {
                document.body.classList.add('blurred'); // Blur content
                setTimeout(() => document.body.classList.remove('blurred'), 2000); // Unblur after 2 seconds
            }
        });
    </script>
</body>
</html>
